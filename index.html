<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">üåô Dark</button>
    <button class="settings-btn" onclick="openSettings()">‚öôÔ∏è Settings</button>
    
    <div class="container">
        <div class="calculator">
            <div class="display">
                <div class="memory-indicator" id="memoryIndicator" style="display: none;">M</div>
                <div class="previous-operand" id="previousOperand"></div>
                <div class="current-operand" id="currentOperand">0</div>
            </div>
            <div class="buttons">
                <button class="function" onclick="memoryRecall()">MR</button>
                <button class="function" onclick="memoryAdd()">M+</button>
                <button class="function" onclick="memoryClear()">MC</button>
                <button class="operator" onclick="chooseOperation('√∑')">√∑</button>
                
                <button class="number" onclick="appendNumber('7')">7</button>
                <button class="number" onclick="appendNumber('8')">8</button>
                <button class="number" onclick="appendNumber('9')">9</button>
                <button class="operator" onclick="chooseOperation('√ó')">√ó</button>
                
                <button class="number" onclick="appendNumber('4')">4</button>
                <button class="number" onclick="appendNumber('5')">5</button>
                <button class="number" onclick="appendNumber('6')">6</button>
                <button class="operator" onclick="chooseOperation('-')">-</button>
                
                <button class="number" onclick="appendNumber('1')">1</button>
                <button class="number" onclick="appendNumber('2')">2</button>
                <button class="number" onclick="appendNumber('3')">3</button>
                <button class="operator" onclick="chooseOperation('+')">+</button>
                
                <button class="clear" onclick="clearAll()">AC</button>
                <button class="number" onclick="appendNumber('0')">0</button>
                <button class="decimal" onclick="appendNumber('.')">.</button>
                <button class="operator" onclick="deleteDigit()">DEL</button>
                
                <button class="function" onclick="calculatePercentage()">%</button>
                <button class="function" onclick="calculateSquare()">x¬≤</button>
                <button class="function" onclick="calculateSquareRoot()">‚àö</button>
                <button class="equals" onclick="calculate()">=</button>
            </div>
        </div>

        <div class="history-panel" id="historyPanel">
            <div class="history-header">
                <h2>üìä History</h2>
            </div>
            
            <div class="history-stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalCalcs">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="todayCalcs">0</div>
                    <div class="stat-label">Today</div>
                </div>
            </div>

            <div class="history-search">
                <input type="text" id="historySearch" placeholder="üîç Search history..." oninput="searchHistory()">
            </div>

            <div class="history-actions">
                <button class="export-history" onclick="exportHistory()">üì• Export</button>
                <button class="clear-history" onclick="clearHistory()">üóëÔ∏è Clear</button>
            </div>
            
            <div class="history-list" id="historyList">
                <div class="empty-history">No calculations yet</div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Preferences</h2>
                <button class="close-modal" onclick="closeSettings()">√ó</button>
            </div>
            
            <div class="preference-group">
                <h3>üé® Display Settings</h3>
                <div class="preference-option">
                    <div>
                        <label>Show History Panel</label>
                        <div class="preference-description">Toggle history sidebar visibility</div>
                    </div>
                    <div class="toggle-switch active" id="showHistoryToggle" onclick="toggleHistoryPanel()"></div>
                </div>
                <div class="preference-option">
                    <div>
                        <label>Sound Effects</label>
                        <div class="preference-description">Enable button click sounds</div>
                    </div>
                    <div class="toggle-switch" id="soundToggle" onclick="toggleSound()"></div>
                </div>
                <div class="preference-option">
                    <div>
                        <label>Animations</label>
                        <div class="preference-description">Enable smooth transitions</div>
                    </div>
                    <div class="toggle-switch active" id="animationsToggle" onclick="toggleAnimations()"></div>
                </div>
            </div>

            <div class="preference-group">
                <h3>üé® Theme Colors</h3>
                <div class="preference-option">
                    <label>Primary Color</label>
                    <input type="color" id="primaryColor" value="#11998e" onchange="updatePrimaryColor()">
                </div>
                <div class="preference-option">
                    <label>Secondary Color</label>
                    <input type="color" id="secondaryColor" value="#38ef7d" onchange="updateSecondaryColor()">
                </div>
                <div class="preference-option">
                    <label>Background Start</label>
                    <input type="color" id="bgColorStart" value="#0f2027" onchange="updateBgColors()">
                </div>
                <div class="preference-option">
                    <label>Background End</label>
                    <input type="color" id="bgColorEnd" value="#2c5364" onchange="updateBgColors()">
                </div>
                <div class="preference-option" style="justify-content: center;">
                    <button class="clear-history full-width" onclick="resetColors()">üîÑ Reset to Default</button>
                </div>
            </div>

            <div class="preference-group">
                <h3>‚ùì Help & Documentation</h3>
                <div class="preference-option" style="justify-content: center;">
                    <button class="clear-history full-width" onclick="openHelp()">üìö Open Help Guide</button>
                </div>
            </div>

            <div class="preference-group">
                <h3>üî¢ Calculation Settings</h3>
                <div class="preference-option">
                    <label>Decimal Places</label>
                    <select id="decimalPlaces" onchange="updateDecimalPlaces()">
                        <option value="auto">Auto</option>
                        <option value="2">2</option>
                        <option value="4">4</option>
                        <option value="6">6</option>
                        <option value="8">8</option>
                        <option value="10">10</option>
                    </select>
                </div>
                <div class="preference-option">
                    <div>
                        <label>Thousands Separator</label>
                        <div class="preference-description">Format large numbers (1,000)</div>
                    </div>
                    <div class="toggle-switch" id="separatorToggle" onclick="toggleSeparator()"></div>
                </div>
            </div>

            <div class="preference-group">
                <h3>üìú History Settings</h3>
                <div class="preference-option">
                    <label>Max History Items</label>
                    <select id="maxHistory" onchange="updateMaxHistory()">
                        <option value="10">10</option>
                        <option value="20" selected>20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="500">500</option>
                    </select>
                </div>
                <div class="preference-option">
                    <div>
                        <label>Auto-Save History</label>
                        <div class="preference-description">Automatically save calculations</div>
                    </div>
                    <div class="toggle-switch active" id="autoSaveToggle" onclick="toggleAutoSave()"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ùì Help & Guide</h2>
                <button class="close-modal" onclick="closeHelp()">√ó</button>
            </div>
            
            <div class="help-section">
                <h3>üéØ Basic Operations</h3>
                <p>Use the number buttons (0-9) and operation buttons (+, -, √ó, √∑) to perform calculations.</p>
                <ul>
                    <li><strong>AC</strong> - All Clear: Resets the calculator</li>
                    <li><strong>DEL</strong> - Delete: Removes the last digit</li>
                    <li><strong>=</strong> - Calculates the result</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>üîß Advanced Functions</h3>
                <ul>
                    <li><strong>%</strong> - Percentage: Calculates percentage of current number</li>
                    <li><strong>x¬≤</strong> - Square: Squares the current number</li>
                    <li><strong>‚àö</strong> - Square Root: Calculates square root</li>
                    <li><strong>MR</strong> - Memory Recall: Retrieves stored value</li>
                    <li><strong>M+</strong> - Memory Add: Adds current value to memory</li>
                    <li><strong>MC</strong> - Memory Clear: Clears stored memory</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                <ul>
                    <li><span class="keyboard-shortcut">0-9</span> - Number input</li>
                    <li><span class="keyboard-shortcut">+</span> <span class="keyboard-shortcut">-</span> <span class="keyboard-shortcut">*</span> <span class="keyboard-shortcut">/</span> - Operations</li>
                    <li><span class="keyboard-shortcut">Enter</span> or <span class="keyboard-shortcut">=</span> - Calculate</li>
                    <li><span class="keyboard-shortcut">Esc</span> - Clear all</li>
                    <li><span class="keyboard-shortcut">Backspace</span> - Delete last digit</li>
                    <li><span class="keyboard-shortcut">.</span> - Decimal point</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>üìä History Features</h3>
                <ul>
                    <li><strong>Search</strong> - Find specific calculations</li>
                    <li><strong>Export</strong> - Download history as text file</li>
                    <li><strong>Click item</strong> - Reuse previous calculation</li>
                    <li><strong>Delete icon</strong> - Remove individual items</li>
                </ul>
            </div>

            <div class="help-section">
                <h3>‚öôÔ∏è Settings</h3>
                <p>Customize your calculator experience:</p>
                <ul>
                    <li><strong>Theme Colors</strong> - Personalize appearance</li>
                    <li><strong>Decimal Places</strong> - Control precision</li>
                    <li><strong>History Limit</strong> - Set max saved items</li>
                    <li><strong>Animations</strong> - Enable/disable effects</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div class="modal" id="confirmDialog">
        <div class="modal-content confirm-dialog">
            <h2 id="confirmTitle">Confirm Action</h2>
            <p id="confirmMessage">Are you sure?</p>
            <div class="confirm-buttons">
                <button class="confirm-btn cancel" onclick="closeConfirmDialog()">Cancel</button>
                <button class="confirm-btn confirm" id="confirmActionBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script src="script.js" defer></script>
</body>
</html>